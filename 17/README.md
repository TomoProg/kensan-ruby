# 今週のテーマ
堅牢なウェブアプリケーションのセキュリティ

# 方針
Rubyのというより、一般的なセキュリティ知識の向上を目指す
全体をざっと読んでみる

## 17.1 Ruby のウェブアプリケーションにおけるセキュリ ティ上の問題は、ほとんどが高レイヤのもの
C拡張が同梱されているgemってどういうことだろう？  
C言語で書かれたライブラリがgemに入ってるってことかな？  

Rubyでは必要に応じて長さを変える文字列やIntegerが任意の大きさの整数を表せる、ガベージコレクタが備わっているなど、バッファオーバーフローや解放したメモリを誤って参照するといった脆弱性は起きにくい。

## 17.2 入力を信用してはならない
exitはKernel#exitなので、Kernelを継承してるとexitを呼び出せるのね。  

ブラックリスト方式だと、無限にブラックリストに追加していくのは無理なので、ホワイトリスト方式で許可する入力だけを設定しておく。  
受け取ったパラメータの型を想定している型に強制することで、型の違いによるセキュリティ上の問題を回避できる  

## 17.3 可能な限りの高レイヤでアクセスを制御する

before_actionによるログイン有無のチェックが題材  
only、exceptの使い方としてはフェイルクローズドな方を使うのをおすすめする  

- フェイルクローズド：故障したら中断する  
- フェイルオープン：故障してもそのまま続行する

## 17.4 インジェクション対策

### スクリプトインジェクション
パラメータにスクリプトを入れて、それを実行させる  
パラメータをそのまま画面に出力するといった処理がある場合は要注意  
`<%==`で自動的にエスケープできるらしい。  
Railsでは`<%=`でエスケープする。エスケープしたくない場合はhtml_safeメソッド  

Content-Security-Policyヘッダをscript-src 'self'にするとインラインのJavaScriptを実行できなくなる  
知らなかった。

### SQLインジェクション
SQL文字列に外部から与えられた文字列を直接埋め込んでいる場合は要注意

### コードインジェクション
...



